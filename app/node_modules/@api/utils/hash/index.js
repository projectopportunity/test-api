const bcrypt = require('bcryptjs')

module.exports = {
  createHash: (plainText) => {
    if (!plainText || typeof plainText !== 'string') {
      throw new Error('Please provide a non-empty string')
    }
            
    return bcrypt.hashSync(plainText, 10)
    },

    compareToHash: (plainText, originalHash) => {
      if (!plainText || typeof plainText !== 'string') {
        throw new Error('Please provide a plain text string and a hashed value to compare it to')
      }

      if (!originalHash || typeof originalHash !== 'string') {
        throw new Error('Please provide a plain text string and a hashed value to compare it to')
      }
            
      return bcrypt.compareSync(plainText, originalHash)
    }
}
