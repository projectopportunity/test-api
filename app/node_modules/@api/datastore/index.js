const { Sequelize } = require('sequelize')

class DataStore {
  async init (connectionString) {
    let myURL

    try {
      myURL = new URL(connectionString)
    } catch {
      throw new Error('the init method requires a connection string parameter that is in the form of a URI')
    }

    const sequelize = new Sequelize(connectionString)

    return sequelize.authenticate()
  }

  async createUser () {
    throw new Error()
  }
}

let sharedInstance = null

module.exports = () => {
  if (sharedInstance === null) {
    sharedInstance = new DataStore()
  }

  return sharedInstance
}
